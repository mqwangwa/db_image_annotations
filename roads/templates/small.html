<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Feature Map</title>

        <!-- Leaflet.js -->
        <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" /> 
        <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

        <style>
            #map {
                height: 80vh;
                width: 100%;
            }
        </style>
    </head>
    <body>
        <header style="text-align: center;">
            <h1>Feature Map</h1>
        </header>

        <main>
            <div id="checkboxes"></div>
            <div id="map"></div>
        </main>

        <script>
            // Initialize the map
            const map = L.map('map').setView([42.350650, -71.061522], 17);

            // Add OpenStreetMap tile layer
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
            }).addTo(map);

            // data
            const jsonObj = {"tree": {"61317323": {"lat": 42.3696011, "long": -71.1181455}, "61321986": {"lat": 42.37226, "long": -71.1193492}, "61324477": {"lat": 42.3728963, "long": -71.1171159}, "61324503": {"lat": 42.3731211, "long": -71.1179145}, "61325428": {"lat": 42.3719839, "long": -71.1185717}, "61325608": {"lat": 42.3726977, "long": -71.1164118}, "61329582": {"lat": 42.3723288, "long": -71.1165824}, "435099116": {"lat": 42.3725225, "long": -71.1172874}, "621110035": {"lat": 42.3730938, "long": -71.1178178}, "663712109": {"lat": 42.3732575, "long": -71.1187502}, "1001516277": {"lat": 42.3722058, "long": -71.1155943}, "2049832619": {"lat": 42.3725547, "long": -71.1160318}, "5645093171": {"lat": 42.3733106, "long": -71.1185178}, "6124562830": {"lat": 42.3736741, "long": -71.1188321}, "6298024782": {"lat": 42.3732508, "long": -71.1183708}, "7628877230": {"lat": 42.3730326, "long": -71.1179656}, "7628877232": {"lat": 42.3728074, "long": -71.1171567}, "7629147296": {"lat": 42.372604, "long": -71.1164551}, "8754581049": {"lat": 42.3723962, "long": -71.1158273}, "11729271627": {"lat": 42.3726772, "long": -71.1163372}, "11729585231": {"lat": 42.3716368, "long": -71.1176144}, "11765173118": {"lat": 42.3725209, "long": -71.1159175}, "12022101436": {"lat": 42.374002, "long": -71.1188376}, "12099318079": {"lat": 42.3725066, "long": -71.1159651}, "12132822832": {"lat": 42.3725732, "long": -71.1172641}, "12132822869": {"lat": 42.3729497, "long": -71.1189532}, "12132822874": {"lat": 42.3727016, "long": -71.118156}}, "stop_sign": {"61321986": {"lat": 42.37226, "long": -71.1193492}, "61325608": {"lat": 42.3726977, "long": -71.1164118}, "61329582": {"lat": 42.3723288, "long": -71.1165824}, "435099116": {"lat": 42.3725225, "long": -71.1172874}, "7628877230": {"lat": 42.3730326, "long": -71.1179656}, "7629147296": {"lat": 42.372604, "long": -71.1164551}, "11729585231": {"lat": 42.3716368, "long": -71.1176144}}, "crosswalk": {"61317323": {"lat": 42.3696011, "long": -71.1181455}, "61321986": {"lat": 42.37226, "long": -71.1193492}, "61324477": {"lat": 42.3728963, "long": -71.1171159}, "61324503": {"lat": 42.3731211, "long": -71.1179145}, "61325428": {"lat": 42.3719839, "long": -71.1185717}, "61325608": {"lat": 42.3726977, "long": -71.1164118}, "61329582": {"lat": 42.3723288, "long": -71.1165824}, "621110035": {"lat": 42.3730938, "long": -71.1178178}, "663712109": {"lat": 42.3732575, "long": -71.1187502}, "1001516277": {"lat": 42.3722058, "long": -71.1155943}, "2049832619": {"lat": 42.3725547, "long": -71.1160318}, "5645093171": {"lat": 42.3733106, "long": -71.1185178}, "6124562830": {"lat": 42.3736741, "long": -71.1188321}, "6298024782": {"lat": 42.3732508, "long": -71.1183708}, "7628877230": {"lat": 42.3730326, "long": -71.1179656}, "7628877232": {"lat": 42.3728074, "long": -71.1171567}, "7629147296": {"lat": 42.372604, "long": -71.1164551}, "8754581049": {"lat": 42.3723962, "long": -71.1158273}, "11729271627": {"lat": 42.3726772, "long": -71.1163372}, "11729585231": {"lat": 42.3716368, "long": -71.1176144}, "11765173118": {"lat": 42.3725209, "long": -71.1159175}, "12022101436": {"lat": 42.374002, "long": -71.1188376}, "12099318079": {"lat": 42.3725066, "long": -71.1159651}, "12132822859": {"lat": 42.3726086, "long": -71.1172479}, "12132822869": {"lat": 42.3729497, "long": -71.1189532}, "12132822874": {"lat": 42.3727016, "long": -71.118156}, "12132822898": {"lat": 42.3725787, "long": -71.1191662}}, "traffic_light": {"61324503": {"lat": 42.3731211, "long": -71.1179145}, "621110035": {"lat": 42.3730938, "long": -71.1178178}, "2049832619": {"lat": 42.3725547, "long": -71.1160318}, "6124562830": {"lat": 42.3736741, "long": -71.1188321}, "6298024782": {"lat": 42.3732508, "long": -71.1183708}, "7628877230": {"lat": 42.3730326, "long": -71.1179656}, "8754581049": {"lat": 42.3723962, "long": -71.1158273}, "12099318079": {"lat": 42.3725066, "long": -71.1159651}}, "chinese_calligraphy": {"2049832619": {"lat": 42.3725547, "long": -71.1160318}, "8754581049": {"lat": 42.3723962, "long": -71.1158273}, "11765173118": {"lat": 42.3725209, "long": -71.1159175}, "12099318079": {"lat": 42.3725066, "long": -71.1159651}}, "bike_lane": {"61321986": {"lat": 42.37226, "long": -71.1193492}, "61325428": {"lat": 42.3719839, "long": -71.1185717}, "61325608": {"lat": 42.3726977, "long": -71.1164118}, "621110035": {"lat": 42.3730938, "long": -71.1178178}, "663712109": {"lat": 42.3732575, "long": -71.1187502}, "1001516277": {"lat": 42.3722058, "long": -71.1155943}, "2049832619": {"lat": 42.3725547, "long": -71.1160318}, "5645093171": {"lat": 42.3733106, "long": -71.1185178}, "6298024782": {"lat": 42.3732508, "long": -71.1183708}, "8754581049": {"lat": 42.3723962, "long": -71.1158273}, "11729585231": {"lat": 42.3716368, "long": -71.1176144}, "11765173118": {"lat": 42.3725209, "long": -71.1159175}, "12022101436": {"lat": 42.374002, "long": -71.1188376}, "12099318079": {"lat": 42.3725066, "long": -71.1159651}, "12132822869": {"lat": 42.3729497, "long": -71.1189532}}, "fire_hydrant": {"61324477": {"lat": 42.3728963, "long": -71.1171159}, "61324503": {"lat": 42.3731211, "long": -71.1179145}, "61329582": {"lat": 42.3723288, "long": -71.1165824}, "435099116": {"lat": 42.3725225, "long": -71.1172874}, "663712109": {"lat": 42.3732575, "long": -71.1187502}, "2049832619": {"lat": 42.3725547, "long": -71.1160318}, "7628877230": {"lat": 42.3730326, "long": -71.1179656}, "7629147296": {"lat": 42.372604, "long": -71.1164551}, "12132822832": {"lat": 42.3725732, "long": -71.1172641}, "12132822859": {"lat": 42.3726086, "long": -71.1172479}, "12132822869": {"lat": 42.3729497, "long": -71.1189532}}, "sidewalk": {"61317323": {"lat": 42.3696011, "long": -71.1181455}, "61321986": {"lat": 42.37226, "long": -71.1193492}, "61324477": {"lat": 42.3728963, "long": -71.1171159}, "61324503": {"lat": 42.3731211, "long": -71.1179145}, "61325428": {"lat": 42.3719839, "long": -71.1185717}, "61325608": {"lat": 42.3726977, "long": -71.1164118}, "61329582": {"lat": 42.3723288, "long": -71.1165824}, "435099116": {"lat": 42.3725225, "long": -71.1172874}, "621110035": {"lat": 42.3730938, "long": -71.1178178}, "663712109": {"lat": 42.3732575, "long": -71.1187502}, "1001516277": {"lat": 42.3722058, "long": -71.1155943}, "2049832619": {"lat": 42.3725547, "long": -71.1160318}, "5645093171": {"lat": 42.3733106, "long": -71.1185178}, "6124562830": {"lat": 42.3736741, "long": -71.1188321}, "6298024782": {"lat": 42.3732508, "long": -71.1183708}, "7628877230": {"lat": 42.3730326, "long": -71.1179656}, "7628877232": {"lat": 42.3728074, "long": -71.1171567}, "7629147296": {"lat": 42.372604, "long": -71.1164551}, "8754581049": {"lat": 42.3723962, "long": -71.1158273}, "11729271627": {"lat": 42.3726772, "long": -71.1163372}, "11729585231": {"lat": 42.3716368, "long": -71.1176144}, "11765173118": {"lat": 42.3725209, "long": -71.1159175}, "12022101436": {"lat": 42.374002, "long": -71.1188376}, "12099318079": {"lat": 42.3725066, "long": -71.1159651}, "12132822832": {"lat": 42.3725732, "long": -71.1172641}, "12132822859": {"lat": 42.3726086, "long": -71.1172479}, "12132822869": {"lat": 42.3729497, "long": -71.1189532}, "12132822874": {"lat": 42.3727016, "long": -71.118156}, "12132822898": {"lat": 42.3725787, "long": -71.1191662}}};

            // dynamic add checkboxes
            checkboxes = document.getElementById("checkboxes");
            for (col of Object.keys(jsonObj)) {
                checkboxes.innerHTML += `<label><input type="radio" name="radioGroup" id="${col}"> ${col} </label>`;
            }

            // get group of markers
            const size = "150";
            const bindings = {};
            const bounds = {};
            for (col of Object.keys(jsonObj)) {
                temp = [];
                min_lat = 91
                max_lat = -91
                min_long = 181
                max_long = -181
                for ([id, value] of Object.entries(jsonObj[col])) {
                    temp.push(L.marker([value["lat"], value["long"]]).bindPopup("<div style=\"font-size: 20px;\">" + "(id: " + id + ")" + "</div>" + `<img src=\"../../data/${id}_0.jpg\" width=\"${size}\" height=\"${size}\"">` + `<img src=\"../../data/${id}_90.jpg\" width=\"${size}\" height=\"${size}\"">` + `<img src=\"../../data/${id}_180.jpg\" width=\"${size}\" height=\"${size}\"">` + `<img src=\"../../data/${id}_270.jpg\" width=\"${size}\" height=\"${size}\"">`, {
                        maxWidth: 4 * size
                    }));

                    min_lat = Math.min(min_lat, value["lat"]);
                    max_lat = Math.max(max_lat, value["lat"]);
                    min_long = Math.min(min_long, value["long"]);
                    max_long = Math.max(max_long, value["long"]);
                }
                group = L.layerGroup(temp);
                bindings[col] = group;

                b = L.latLngBounds([min_lat, min_long], [max_lat, max_long]);
                bounds[col] = b;
            }

            // add event handlers
            for (col of Object.keys(jsonObj)) {
                document.getElementById(col).addEventListener("change", function (e) {
                    if (e.target.checked) {
                        // clear all other marker layers
                        for ([_, layer] of Object.entries(bindings)) {
                            map.removeLayer(layer)
                        }
                        map.addLayer(bindings[e.target.id])

                        // center the map
                        map.fitBounds(bounds[e.target.id])
                    }
                });
            }
        </script>
    </body>
</html>